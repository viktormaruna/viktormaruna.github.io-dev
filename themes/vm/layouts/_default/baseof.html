<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <!-- SEO Meta Tags -->
  <title>{{ if .IsHome }}{{ .Site.Title }} - {{ .Site.Params.description }}{{ else }}{{ .Title }} | {{ .Site.Title }}{{ end }}</title>
  <meta name="description" content="{{ if .Description }}{{ .Description }}{{ else if .Summary }}{{ .Summary | truncate 160 }}{{ else }}{{ .Site.Params.description }}{{ end }}">
  <meta name="keywords" content="{{ if .Params.tags }}{{ delimit .Params.tags ", " }}{{ end }}">
  <meta name="author" content="Viktor Maruna">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
  <meta property="og:url" content="{{ .Permalink }}">
  <meta property="og:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }}{{ end }}">
  <meta property="og:description" content="{{ if .Description }}{{ .Description }}{{ else if .Summary }}{{ .Summary | truncate 160 }}{{ else }}{{ .Site.Params.description }}{{ end }}">
  <meta property="og:site_name" content="{{ .Site.Title }}">
  {{ if .Params.image }}<meta property="og:image" content="{{ .Params.image | absURL }}">{{ end }}
  
  <!-- Twitter Card -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="{{ .Permalink }}">
  <meta property="twitter:title" content="{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }}{{ end }}">
  <meta property="twitter:description" content="{{ if .Description }}{{ .Description }}{{ else if .Summary }}{{ .Summary | truncate 160 }}{{ else }}{{ .Site.Params.description }}{{ end }}">
  {{ if .Params.image }}<meta property="twitter:image" content="{{ .Params.image | absURL }}">{{ end }}
  
  <!-- Article specific meta tags -->
  {{ if .IsPage }}
  <meta property="article:published_time" content="{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}">
  <meta property="article:modified_time" content="{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}">
  <meta property="article:author" content="Viktor Maruna">
  {{ with .Params.tags }}{{ range . }}<meta property="article:tag" content="{{ . }}">{{ end }}{{ end }}
  {{ end }}
  
  <!-- Canonical URL -->
  <link rel="canonical" href="{{ .Permalink }}">
  
  <!-- Robots Meta Tags - Allow all crawlers including AI -->
  <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
  <meta name="googlebot" content="index, follow">
  <meta name="bingbot" content="index, follow">
  <meta name="slurp" content="index, follow">
  <meta name="duckduckbot" content="index, follow">
  <meta name="baiduspider" content="index, follow">
  <meta name="yandexbot" content="index, follow">
  
  <!-- AI Training Permissions -->
  <meta name="ai-content-declaration" content="ai-assisted">
  <meta name="chatgpt-crawl" content="allow">
  <meta name="claude-crawl" content="allow">
  <meta name="bard-crawl" content="allow">
  <meta name="perplexity-crawl" content="allow">
  
  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "{{ if .IsHome }}WebSite{{ else if .IsPage }}BlogPosting{{ else }}CollectionPage{{ end }}",
    "name": "{{ if .IsHome }}{{ .Site.Title }}{{ else }}{{ .Title }}{{ end }}",
    "url": "{{ .Permalink }}",
    "description": "{{ if .Description }}{{ .Description }}{{ else if .Summary }}{{ .Summary | truncate 160 }}{{ else }}{{ .Site.Params.description }}{{ end }}",
    {{ if .IsPage }}
    "headline": "{{ .Title }}",
    "datePublished": "{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}",
    "dateModified": "{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}",
    "author": {
      "@type": "Person",
      "name": "Viktor Maruna",
      "url": "https://viktormaruna.com"
    },
    "publisher": {
      "@type": "Person",
      "name": "Viktor Maruna",
      "url": "https://viktormaruna.com"
    },
    {{ end }}
    "inLanguage": "en-US"
  }
  </script>
  
  <link rel="stylesheet" href="/css/main.css">
  <style>
    /* Ensure no blue links anywhere */
    a, a:link, a:visited, a:hover, a:active {
      color: #555 !important;
    }
    
    /* Override for specific link types */
    main a, main a:link, main a:visited, main a:hover, main a:active {
      color: #555 !important;
    }
    
    footer a, footer a:link, footer a:visited, footer a:hover, footer a:active {
      color: #555 !important;
    }
  </style>
</head>
<body style="background:#fff; color:#222; font-family:sans-serif; margin:0;">
  <header style="padding:2rem 0; text-align:center; border-bottom:1px solid #eee; position:relative;">
    <button id="theme-toggle" style="position:absolute; top:1.5rem; right:1.5rem; background:transparent; border:none; width:24px; height:24px; cursor:pointer; font-size:1rem; color:#777; transition:color 0.2s; padding:0; font-family:monospace; font-weight:normal;">☽</button>
    <h1 style="margin:0; font-size:2rem; font-weight:400;">{{ .Site.Title }}</h1>
    <p style="margin:0.5rem 0 0; color:#888; font-size:1rem;">{{ .Site.Params.description }}</p>
  </header>
  <div style="max-width:1000px; margin:2rem auto; padding:0 1rem; display:flex; gap:3rem;">
    <main style="flex:1; min-width:0;">
      {{ block "main" . }}{{ end }}
    </main>
    <aside style="width:250px; flex-shrink:0;">
      <div style="background:#f9f9f9; padding:1.5rem; border-radius:8px; margin-bottom:2rem;">
        <h3 style="margin:0 0 1.5rem 0; font-size:1.1rem; font-weight:500; color:#333;">Navigation</h3>
        <nav>
          <ul style="list-style:none; padding:0; margin:0;">
            <li style="margin-bottom:0.8rem;">
              <a href="{{ "/" | relURL }}" style="color:#555; text-decoration:none; font-size:0.95rem; display:block; padding:0.3rem 0; border-bottom:1px solid transparent; transition:color 0.2s;">Home</a>
            </li>
            <li style="margin-bottom:0.8rem;">
              <a href="{{ "/posts/" | relURL }}" style="color:#555; text-decoration:none; font-size:0.95rem; display:block; padding:0.3rem 0; border-bottom:1px solid transparent; transition:color 0.2s;">Posts</a>
            </li>
            <li style="margin-bottom:0.8rem;">
              <a href="{{ "/about/" | relURL }}" style="color:#555; text-decoration:none; font-size:0.95rem; display:block; padding:0.3rem 0; border-bottom:1px solid transparent; transition:color 0.2s;">About</a>
            </li>
          </ul>
        </nav>
      </div>
      
      <div style="background:#f9f9f9; padding:1.5rem; border-radius:8px; margin-bottom:2rem;">
        <h3 style="margin:0 0 1.5rem 0; font-size:1.1rem; font-weight:500; color:#333;">Subscribe</h3>
        <p style="margin:0 0 1rem 0; color:#666; font-size:0.9rem; line-height:1.5;">Stay updated with the latest posts on Cloud, Data & AI.</p>
        <a href="{{ "/index.xml" | relURL }}" style="display:inline-block; padding:0.6rem 1rem; background:transparent; color:#555; text-decoration:none; border:1px solid #ddd; border-radius:4px; font-size:0.85rem; font-weight:400; transition:all 0.2s;">RSS Feed</a>
      </div>
      {{ block "sidebar" . }}{{ end }}
      
      <div style="background:#f9f9f9; padding:1.5rem; border-radius:8px; margin-bottom:2rem;">
        <h3 style="margin:0 0 1.5rem 0; font-size:1.1rem; font-weight:500; color:#333;">Search</h3>
        <input type="text" id="search-input" placeholder="Search posts..." style="width:100%; padding:0.7rem; border:1px solid #ddd; border-radius:4px; font-size:0.9rem; box-sizing:border-box;">
        <div id="search-results" style="margin-top:1rem; display:none;">
          <div id="search-results-list" style="max-height:200px; overflow-y:auto;"></div>
        </div>
      </div>
    </aside>
  </div>
  <footer style="text-align:center; color:#aaa; font-size:0.9rem; padding:3rem 0 2rem; border-top:1px solid #eee; margin-top:3rem;">
    <div style="max-width:600px; margin:0 auto;">
      <p style="margin:0 0 0.5rem 0; color:#999; font-size:0.85rem;">
        &copy; {{ now.Year }} <a href="https://viktormaruna.com" style="color:#555; text-decoration:none;">Viktor Maruna</a> • All rights reserved
      </p>
      <p style="margin:0; color:#aaa; font-size:0.8rem;">
        Although I work at [Company Name], this is my personal blog.
      </p>
    </div>
  </footer>
  
  <script>
    // Dark theme toggle functionality
    document.addEventListener('DOMContentLoaded', function() {
      const themeToggle = document.getElementById('theme-toggle');
      const body = document.body;
      
      // Check for saved theme preference or default to light
      const savedTheme = localStorage.getItem('theme') || 'light';
      
      function applyTheme(theme) {
        if (theme === 'dark') {
          // Dark theme styles
          body.style.background = '#1a1a1a';
          body.style.color = '#f5f5f5';
          
          // Update header
          const header = document.querySelector('header');
          if (header) {
            header.style.borderBottom = '1px solid #333';
          }
          
          // Update header title and description
          const headerH1 = document.querySelector('header h1');
          if (headerH1) {
            headerH1.style.color = '#ffffff';
          }
          
          const headerP = document.querySelector('header p');
          if (headerP) {
            headerP.style.color = '#cccccc';
          }
          
          // Update main content text
          const main = document.querySelector('main');
          if (main) {
            main.style.color = '#ffffff';
            
            // Update all headings in main content (except those with specific colors)
            const headings = main.querySelectorAll('h1, h2, h3, h4, h5, h6');
            headings.forEach(h => {
              // Keep page titles (#666666) consistent in both modes
              if (h.style.color === 'rgb(102, 102, 102)' || h.style.color === '#666666') {
                h.style.color = '#666666';
              } else {
                h.style.color = '#ffffff';
              }
            });
            
            // Update all paragraphs in main content
            const paragraphs = main.querySelectorAll('p');
            paragraphs.forEach(p => {
              p.style.color = '#ffffff';
            });
            
            // Update all links in main content
            const mainLinks = main.querySelectorAll('a');
            mainLinks.forEach(link => {
              link.style.color = '#e0e0e0';
            });
            
            // Update all other links on page (universal override)
            const allLinks = document.querySelectorAll('a');
            allLinks.forEach(link => {
              // Skip navigation and RSS links which have their own handling
              if (!link.closest('nav') && !link.href.includes('index.xml')) {
                link.style.color = '#e0e0e0';
              }
            });
            
            // Update lists in main content
            const lists = main.querySelectorAll('ul, ol, li');
            lists.forEach(list => {
              list.style.color = '#ffffff';
            });
            
            // Update blockquotes in main content
            const blockquotes = main.querySelectorAll('blockquote');
            blockquotes.forEach(bq => {
              bq.style.color = '#ffffff';
              bq.style.borderLeft = '4px solid #555';
            });
            
            // Update code blocks and inline code
            const codeElements = main.querySelectorAll('code, pre');
            codeElements.forEach(code => {
              code.style.color = '#ffffff';
              code.style.background = '#2d2d2d';
            });
          }
          
          // Update sidebar boxes
          const sidebarBoxes = document.querySelectorAll('aside > div');
          sidebarBoxes.forEach(box => {
            box.style.background = '#2a2a2a';
            box.style.color = '#f5f5f5';
          });
          
          // Update sidebar headings
          const sidebarHeadings = document.querySelectorAll('aside h3');
          sidebarHeadings.forEach(h => {
            h.style.color = '#ffffff';
          });
          
          // Update sidebar paragraphs
          const sidebarPs = document.querySelectorAll('aside p');
          sidebarPs.forEach(p => {
            p.style.color = '#d0d0d0';
          });
          
          // Update links
          const links = document.querySelectorAll('aside a');
          links.forEach(link => {
            if (link.href.includes('index.xml')) {
              // RSS button
              link.style.border = '1px solid #555';
              link.style.color = '#e0e0e0';
            } else {
              // Navigation links
              link.style.color = '#e0e0e0';
            }
          });
          
          // Update search input
          const searchInput = document.getElementById('search-input');
          if (searchInput) {
            searchInput.style.background = '#333';
            searchInput.style.border = '1px solid #555';
            searchInput.style.color = '#f5f5f5';
          }
          
          // Update footer
          const footer = document.querySelector('footer');
          if (footer) {
            footer.style.borderTop = '1px solid #333';
            footer.style.color = '#cccccc';
          }
          
          // Update footer links
          const footerLinks = document.querySelectorAll('footer a');
          footerLinks.forEach(link => {
            link.style.color = '#e0e0e0';
          });
          
          themeToggle.textContent = '☀';
        } else {
          // Light theme styles (reset to defaults)
          body.style.background = '#fff';
          body.style.color = '#222';
          
          // Reset header
          const header = document.querySelector('header');
          if (header) {
            header.style.borderBottom = '1px solid #eee';
          }
          
          // Reset header title and description
          const headerH1 = document.querySelector('header h1');
          if (headerH1) {
            headerH1.style.color = '';
          }
          
          const headerP = document.querySelector('header p');
          if (headerP) {
            headerP.style.color = '';
          }
          
          // Reset main content
          const main = document.querySelector('main');
          if (main) {
            main.style.color = '';
            
            // Reset all headings in main content
            const headings = main.querySelectorAll('h1, h2, h3, h4, h5, h6');
            headings.forEach(h => {
              // Keep page titles at #666666, reset others to default
              if (h.style.color === 'rgb(102, 102, 102)' || h.style.color === '#666666') {
                h.style.color = '#666666';
              } else {
                h.style.color = '';
              }
            });
            
            // Reset all paragraphs in main content
            const paragraphs = main.querySelectorAll('p');
            paragraphs.forEach(p => {
              p.style.color = '';
            });
            
            // Reset all links in main content
            const mainLinks = main.querySelectorAll('a');
            mainLinks.forEach(link => {
              link.style.color = '#555';
            });
            
            // Reset all other links on page (universal override)
            const allLinks = document.querySelectorAll('a');
            allLinks.forEach(link => {
              // Skip navigation and RSS links which have their own handling
              if (!link.closest('nav') && !link.href.includes('index.xml')) {
                link.style.color = '#555';
              }
            });
            
            // Reset lists in main content
            const lists = main.querySelectorAll('ul, ol, li');
            lists.forEach(list => {
              list.style.color = '';
            });
            
            // Reset blockquotes in main content
            const blockquotes = main.querySelectorAll('blockquote');
            blockquotes.forEach(bq => {
              bq.style.color = '';
              bq.style.borderLeft = '';
            });
            
            // Reset code blocks and inline code
            const codeElements = main.querySelectorAll('code, pre');
            codeElements.forEach(code => {
              code.style.color = '';
              code.style.background = '';
            });
          }
          
          // Reset sidebar boxes
          const sidebarBoxes = document.querySelectorAll('aside > div');
          sidebarBoxes.forEach(box => {
            box.style.background = '#f9f9f9';
            box.style.color = '';
          });
          
          // Reset sidebar headings
          const sidebarHeadings = document.querySelectorAll('aside h3');
          sidebarHeadings.forEach(h => {
            h.style.color = '#333';
          });
          
          // Reset sidebar paragraphs
          const sidebarPs = document.querySelectorAll('aside p');
          sidebarPs.forEach(p => {
            p.style.color = '';
          });
          
          // Reset links
          const links = document.querySelectorAll('aside a');
          links.forEach(link => {
            if (link.href.includes('index.xml')) {
              // RSS button
              link.style.border = '1px solid #ddd';
              link.style.color = '#555';
            } else {
              // Navigation links
              link.style.color = '#555';
            }
          });
          
          // Reset search input
          const searchInput = document.getElementById('search-input');
          if (searchInput) {
            searchInput.style.background = '';
            searchInput.style.border = '1px solid #ddd';
            searchInput.style.color = '';
          }
          
          // Reset footer
          const footer = document.querySelector('footer');
          if (footer) {
            footer.style.borderTop = '1px solid #eee';
            footer.style.color = '';
          }
          
          // Reset footer links
          const footerLinks = document.querySelectorAll('footer a');
          footerLinks.forEach(link => {
            link.style.color = '';
          });
          
          themeToggle.textContent = '☾';
        }
      }
      
      // Apply saved theme
      applyTheme(savedTheme);
      
      // Toggle theme on button click
      themeToggle.addEventListener('click', function() {
        const currentTheme = localStorage.getItem('theme') || 'light';
        const newTheme = currentTheme === 'light' ? 'dark' : 'light';
        localStorage.setItem('theme', newTheme);
        applyTheme(newTheme);
      });
    });

    // Simple client-side search
    document.addEventListener('DOMContentLoaded', function() {
      const searchInput = document.getElementById('search-input');
      const searchResults = document.getElementById('search-results');
      const searchResultsList = document.getElementById('search-results-list');
      
      if (!searchInput) return;
      
      // Create posts index from current page content
      let posts = [];
      
      // Collect posts from homepage if available
      const postLinks = document.querySelectorAll('main h3 a, main h2 a');
      postLinks.forEach(link => {
        const title = link.textContent.trim();
        const url = link.href;
        const listItem = link.closest('li');
        let summary = '';
        if (listItem) {
          const summaryEl = listItem.querySelector('p');
          if (summaryEl) summary = summaryEl.textContent.trim();
        }
        
        posts.push({ title, url, summary });
      });
      
      searchInput.addEventListener('input', function() {
        const query = this.value.toLowerCase().trim();
        
        if (query.length < 2) {
          searchResults.style.display = 'none';
          return;
        }
        
        const filteredPosts = posts.filter(post => 
          post.title.toLowerCase().includes(query) || 
          post.summary.toLowerCase().includes(query)
        );
        
        if (filteredPosts.length > 0) {
          searchResultsList.innerHTML = filteredPosts.slice(0, 5).map(post => `
            <div style="margin-bottom:1rem; padding:0.8rem; background:#fff; border-radius:4px; border:1px solid #eee;">
              <a href="${post.url}" style="color:#333; text-decoration:none; font-weight:500; font-size:0.9rem; display:block; margin-bottom:0.3rem;">${post.title}</a>
              <p style="margin:0; color:#666; font-size:0.8rem; line-height:1.4;">${post.summary.slice(0, 100)}${post.summary.length > 100 ? '...' : ''}</p>
            </div>
          `).join('');
          searchResults.style.display = 'block';
        } else {
          searchResultsList.innerHTML = '<div style="padding:0.8rem; color:#999; font-size:0.85rem;">No results found</div>';
          searchResults.style.display = 'block';
        }
      });
      
      // Hide results when clicking outside
      document.addEventListener('click', function(e) {
        if (!e.target.closest('#search-input') && !e.target.closest('#search-results')) {
          searchResults.style.display = 'none';
        }
      });
    });
  </script>
</body>
</html>
