<div id="giscus-container" style="margin-top:3rem; padding-top:2rem; border-top:1px solid var(--border);"></div>
  <script>
    (function() {
      var theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'light';
      var script = document.createElement('script');
      script.src = 'https://giscus.app/client.js';
      script.setAttribute('data-repo', '{{ .Site.Params.giscus.repo }}');
      script.setAttribute('data-repo-id', '{{ .Site.Params.giscus.repoId }}');
      script.setAttribute('data-category', '{{ .Site.Params.giscus.category }}');
      script.setAttribute('data-category-id', '{{ .Site.Params.giscus.categoryId }}');
      script.setAttribute('data-mapping', 'pathname');
      script.setAttribute('data-strict', '1');
      script.setAttribute('data-reactions-enabled', '1');
      script.setAttribute('data-emit-metadata', '0');
      script.setAttribute('data-input-position', 'bottom');
      script.setAttribute('data-theme', theme);
      script.setAttribute('data-lang', 'en');
      script.crossOrigin = 'anonymous';
      script.async = true;
      document.getElementById('giscus-container').appendChild(script);

      function syncGiscusTheme() {
        var theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'light';
        var frame = document.querySelector('iframe.giscus-frame');
        if (frame) {
          frame.contentWindow.postMessage({ giscus: { setConfig: { theme: theme } } }, 'https://giscus.app');
        }
      }
      document.getElementById('theme-toggle').addEventListener('click', function() {
        setTimeout(syncGiscusTheme, 100);
      });
    })();
  </script>
