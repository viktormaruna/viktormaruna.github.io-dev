{{ if .Site.Params.giscus.enable }}
<div style="margin-top:3rem; padding-top:2rem; border-top:1px solid var(--border);">
  <script src="https://giscus.app/client.js"
          data-repo="{{ .Site.Params.giscus.repo }}"
          data-repo-id="{{ .Site.Params.giscus.repoId }}"
          data-category="{{ .Site.Params.giscus.category }}"
          data-category-id="{{ .Site.Params.giscus.categoryId }}"
          data-mapping="pathname"
          data-strict="0"
          data-reactions-enabled="1"
          data-emit-metadata="0"
          data-input-position="bottom"
          data-theme="light"
          data-lang="en"
          crossorigin="anonymous"
          async>
  </script>
  <script>
    function syncGiscusTheme() {
      var theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'light';
      var frame = document.querySelector('iframe[src*="giscus"]');
      if (frame) {
        frame.contentWindow.postMessage({ giscus: { setConfig: { theme: theme } } }, 'https://giscus.app');
      }
    }
    document.addEventListener('DOMContentLoaded', function() {
      setTimeout(syncGiscusTheme, 1000);
      document.getElementById('theme-toggle').addEventListener('click', function() {
        setTimeout(syncGiscusTheme, 100);
      });
    });
  </script>
</div>
{{ end }}
